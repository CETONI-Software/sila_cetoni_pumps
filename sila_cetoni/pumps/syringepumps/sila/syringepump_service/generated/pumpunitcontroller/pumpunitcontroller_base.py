# Generated by sila2.code_generator; sila2.__version__: 0.10.1
from __future__ import annotations

from abc import ABC, abstractmethod
from queue import Queue
from typing import TYPE_CHECKING, Any, Optional, Union

from sila2.server import FeatureImplementationBase, MetadataDict

from .pumpunitcontroller_types import SetFlowUnit_Responses, SetVolumeUnit_Responses, VolumeUnit

if TYPE_CHECKING:
    from ...server import Server


class PumpUnitControllerBase(FeatureImplementationBase, ABC):
    parent_server: Server

    _FlowUnit_producer_queue: Queue[Union[Any, Exception]]
    _FlowUnit_current_value: Any

    _VolumeUnit_producer_queue: Queue[Union[VolumeUnit, Exception]]
    _VolumeUnit_current_value: VolumeUnit

    def __init__(self, parent_server: Server):
        """
        Allows to control the currently used units for passing and retrieving flow rates and volumes to and from a pump.
        """
        super().__init__(parent_server=parent_server)

        self._FlowUnit_producer_queue = Queue()

        self._VolumeUnit_producer_queue = Queue()

    def update_FlowUnit(self, FlowUnit: Any, queue: Optional[Queue[Any]] = None) -> None:
        """
        The currently used flow unit.

        This method updates the observable property 'FlowUnit'.

        :param queue: The queue to send updates to. If None, the default Queue will be used.
        """
        if queue is None:
            queue = self._FlowUnit_producer_queue
            self._FlowUnit_current_value = FlowUnit
        queue.put(FlowUnit)

    def FlowUnit_on_subscription(self, *, metadata: MetadataDict) -> Optional[Queue[Any]]:
        """
        The currently used flow unit.

        This method is called when a client subscribes to the observable property 'FlowUnit'

        :param metadata: The SiLA Client Metadata attached to the call
        :return: Optional `Queue` that should be used for updating this property.
            If None, the default Queue will be used.
        """
        pass

    def abort_FlowUnit_subscriptions(self, error: Exception, queue: Optional[Queue[Any]] = None) -> None:
        """
        The currently used flow unit.

        This method aborts subscriptions to the observable property 'FlowUnit'.

        :param error: The Exception to be sent to the subscribing client.
            If it is no DefinedExecutionError or UndefinedExecutionError, it will be wrapped in an UndefinedExecutionError.
        :param queue: The queue to abort. If None, the default Queue will be used.
        """
        if queue is None:
            queue = self._FlowUnit_producer_queue
        queue.put(error)

    @property
    def current_FlowUnit(self) -> Any:
        try:
            return self._FlowUnit_current_value
        except AttributeError:
            raise AttributeError("Observable property FlowUnit has never been set")

    def update_VolumeUnit(self, VolumeUnit: VolumeUnit, queue: Optional[Queue[VolumeUnit]] = None) -> None:
        """
        The currently used volume unit.

        This method updates the observable property 'VolumeUnit'.

        :param queue: The queue to send updates to. If None, the default Queue will be used.
        """
        if queue is None:
            queue = self._VolumeUnit_producer_queue
            self._VolumeUnit_current_value = VolumeUnit
        queue.put(VolumeUnit)

    def VolumeUnit_on_subscription(self, *, metadata: MetadataDict) -> Optional[Queue[VolumeUnit]]:
        """
        The currently used volume unit.

        This method is called when a client subscribes to the observable property 'VolumeUnit'

        :param metadata: The SiLA Client Metadata attached to the call
        :return: Optional `Queue` that should be used for updating this property.
            If None, the default Queue will be used.
        """
        pass

    def abort_VolumeUnit_subscriptions(self, error: Exception, queue: Optional[Queue[VolumeUnit]] = None) -> None:
        """
        The currently used volume unit.

        This method aborts subscriptions to the observable property 'VolumeUnit'.

        :param error: The Exception to be sent to the subscribing client.
            If it is no DefinedExecutionError or UndefinedExecutionError, it will be wrapped in an UndefinedExecutionError.
        :param queue: The queue to abort. If None, the default Queue will be used.
        """
        if queue is None:
            queue = self._VolumeUnit_producer_queue
        queue.put(error)

    @property
    def current_VolumeUnit(self) -> VolumeUnit:
        try:
            return self._VolumeUnit_current_value
        except AttributeError:
            raise AttributeError("Observable property VolumeUnit has never been set")

    @abstractmethod
    def SetFlowUnit(self, FlowUnit: Any, *, metadata: MetadataDict) -> SetFlowUnit_Responses:
        """
        Sets the flow unit for the pump. The flow unit defines the unit to be used for all flow values passed to or retrieved from the pump.


        :param FlowUnit: The flow unit to be set.

        :param metadata: The SiLA Client Metadata attached to the call

        """
        pass

    @abstractmethod
    def SetVolumeUnit(self, VolumeUnit: VolumeUnit, *, metadata: MetadataDict) -> SetVolumeUnit_Responses:
        """
        Sets the default volume unit. The volume unit defines the unit to be used for all volume values passed to or retrieved from the pump.


        :param VolumeUnit: The volume unit for the flow rate.

        :param metadata: The SiLA Client Metadata attached to the call

        """
        pass
